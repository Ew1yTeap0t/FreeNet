<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>SpaceHey Ultra Hub</title>
    <style id="user-styles">/* Кастомные стили пользователя */</style>
    <style>
        body { background: #008080; font-family: 'Tahoma', sans-serif; margin: 0; padding: 20px; transition: all 0.3s; }
        .window { width: 850px; background: #c0c0c0; border: 2px solid #fff; border-right: 2px solid #000; border-bottom: 2px solid #000; margin: 0 auto; overflow: hidden; }
        .title-bar { background: linear-gradient(90deg, navy, #1084d0); color: white; padding: 3px 5px; font-weight: bold; display: flex; justify-content: space-between; }
        
        /* Вкладки */
        .tabs { display: flex; background: #c0c0c0; padding: 5px 5px 0 5px; gap: 2px; border-bottom: 2px solid #888; }
        .tab { padding: 4px 12px; border: 1px solid #000; border-bottom: none; cursor: pointer; background: #999; font-size: 11px; }
        .tab.active { background: #eee; font-weight: bold; position: relative; top: 1px; border-bottom: 1px solid #eee; }

        .main-layout { display: flex; gap: 10px; padding: 10px; height: 550px; }
        .sidebar { width: 200px; background: #eee; border: 2px inset #fff; padding: 10px; font-size: 12px; overflow-y: auto; }
        .content { flex-grow: 1; background: #fff; border: 2px inset #fff; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        
        .page { display: none; flex-direction: column; height: 100%; padding: 10px; box-sizing: border-box; }
        .page.active { display: flex; }

        #messages, #cinema-messages { flex-grow: 1; overflow-y: auto; padding: 10px; background: white; border: 1px inset #ccc; margin-bottom: 5px; }
        .controls { padding: 5px 0; display: flex; gap: 5px; }

        /* Сапер */
        .mines-grid { display: grid; grid-template-columns: repeat(10, 25px); gap: 1px; background: #888; border: 2px solid #000; width: fit-content; margin: 0 auto; }
        .cell { width: 25px; height: 25px; background: #ccc; border: 2px outset #fff; display: flex; align-items: center; justify-content: center; font-size: 14px; cursor: pointer; user-select: none; }
        .cell.open { border: 1px solid #999; background: #ddd; }
        .cell.mine { background: red; }

        /* Рисование */
        #paint-canvas { border: 1px solid #000; background: white; cursor: crosshair; flex-grow: 1; touch-action: none; }
        
        .avatar-big { width: 100%; border: 1px solid #000; margin-bottom: 10px; }
        .snowflake { position: fixed; top: -10px; color: white; pointer-events: none; z-index: 9999; }
    </style>
</head>
<body>

<div class="window">
    <div class="title-bar"><span>MySpace_Mega_Hub.exe</span><span>[?] [X]</span></div>
    
    <div class="tabs">
        <div class="tab active" onclick="switchTab('tab-chat')">Чат</div>
        <div class="tab" onclick="switchTab('tab-cinema')">Кино</div>
        <div class="tab" onclick="switchTab('tab-paint')">Рисование</div>
        <div class="tab" onclick="switchTab('tab-games')">Сапёр</div>
    </div>

    <div class="main-layout">
        <div class="sidebar">
            <img id="view-ava" class="avatar-big" src="https://via.placeholder.com/150" alt="Ava">
            <strong>Профиль:</strong>
            <input type="text" id="nick" placeholder="Ник" style="width: 100%;">
            <input type="text" id="ava" placeholder="URL аватарки" style="width: 100%; margin: 5px 0;">
            <hr>
            <strong>Дизайн:</strong>
            <input type="text" id="bg-url" placeholder="URL фона" style="width: 100%;">
            <textarea id="custom-css" placeholder="CSS код..." style="width: 100%; height: 50px; font-size: 10px;"></textarea>
            <button onclick="applyDesign()" style="width: 100%; background: #ffcc00;">ОБНОВИТЬ</button>
            <button onclick="toggleSnow()" style="width: 100%; margin-top: 5px;">Снег</button>
        </div>

        <div class="content">
            <div id="tab-chat" class="page active">
                <div id="messages"></div>
                <div class="controls">
                    <input type="text" id="msg-input" placeholder="Напиши что-нибудь...">
                    <button onclick="send('messages', 'msg-input')">></button>
                </div>
            </div>

            <div id="tab-cinema" class="page">
                <div class="controls">
                    <input type="text" id="video-url" placeholder="Ссылка на YouTube (v=...)">
                    <button onclick="loadVideo()">Смотреть</button>
                </div>
                <div id="video-container"></div>
                <div id="cinema-messages"></div>
                <div class="controls">
                    <input type="text" id="cinema-msg-input" placeholder="Обсудить видео...">
                    <button onclick="send('cinema-messages', 'cinema-msg-input')">></button>
                </div>
            </div>

            <div id="tab-paint" class="page">
                <div class="controls">
                    Цвет: <input type="color" id="paint-color" value="#000000">
                    Толщина: <input type="range" id="paint-size" min="1" max="20" value="5">
                    <button onclick="clearCanvas()">Очистить</button>
                </div>
                <canvas id="paint-canvas"></canvas>
            </div>

            <div id="tab-games" class="page">
                <h3 style="margin:0 0 10px 0; font-size:14px;">Minesweeper.exe</h3>
                <div id="mines-grid" class="mines-grid"></div>
                <p id="game-status" style="font-size:12px;"></p>
                <button onclick="initMines()">Новая игра</button>
            </div>
        </div>
    </div>
</div>

<script>
    // ПЕРЕКЛЮЧЕНИЕ ВКЛАДОК
    function switchTab(tabId) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        event.currentTarget.classList.add('active');
        if(tabId === 'tab-paint') resizeCanvas();
    }

    // ЧАТ ЛОГИКА
    function send(containerId, inputId) {
        const input = document.getElementById(inputId);
        const nick = document.getElementById('nick').value || 'Аноним';
        const ava = document.getElementById('ava').value || 'https://via.placeholder.com/20';
        if(!input.value) return;

        const html = `<div style="margin-bottom:8px;"><img src="${ava}" style="width:20px; height:20px; vertical-align:middle; border-radius:3px;"> <b>${nick}:</b> ${input.value}</div>`;
        const container = document.getElementById(containerId);
        container.innerHTML += html;
        input.value = '';
        container.scrollTop = container.scrollHeight;
    }

    // КИНО ЛОГИКА
    function loadVideo() {
        const url = document.getElementById('video-url').value;
        let id = "";
        if(url.includes('v=')) id = url.split('v=')[1].split('&')[0];
        else if(url.includes('be/')) id = url.split('be/')[1];
        
        if(id) {
            document.getElementById('video-container').innerHTML = `<iframe width="100%" height="200" src="https://www.youtube.com/embed/${id}" frameborder="0" allowfullscreen></iframe>`;
        } else {
            alert("Вставьте корректную ссылку на YouTube");
        }
    }

    // РИСОВАНИЕ
    const canvas = document.getElementById('paint-canvas');
    const ctx = canvas.getContext('2d');
    let drawing = false;

    function resizeCanvas() {
        canvas.width = canvas.parentElement.clientWidth - 20;
        canvas.height = 300;
    }

    canvas.onmousedown = () => drawing = true;
    canvas.onmouseup = () => { drawing = false; ctx.beginPath(); };
    canvas.onmousemove = (e) => {
        if(!drawing) return;
        ctx.lineWidth = document.getElementById('paint-size').value;
        ctx.lineCap = 'round';
        ctx.strokeStyle = document.getElementById('paint-color').value;
        
        const rect = canvas.getBoundingClientRect();
        ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
        ctx.stroke();
    };
    function clearCanvas() { ctx.clearRect(0,0,canvas.width,canvas.height); }

    // ДИЗАЙН (ИЗ ТВОЕГО КОДА)
    function applyDesign() {
        const bg = document.getElementById('bg-url').value;
        if(bg) document.body.style.backgroundImage = `url('${bg}')`;
        document.getElementById('view-ava').src = document.getElementById('ava').value || 'https://via.placeholder.com/150';
        document.getElementById('user-styles').innerHTML = document.getElementById('custom-css').value;
    }

    function toggleSnow() {
        if(window.snowInterval) { clearInterval(window.snowInterval); window.snowInterval = null; return; }
        window.snowInterval = setInterval(() => {
            const s = document.createElement('div');
            s.className = 'snowflake'; s.innerHTML = '❄';
            s.style.left = Math.random() * window.innerWidth + 'px';
            document.body.appendChild(s);
            let p = -10;
            const f = setInterval(() => { p += 2; s.style.top = p + 'px'; if(p > window.innerHeight) { clearInterval(f); s.remove(); } }, 20);
        }, 200);
    }
</script>
</body>
</html>
